# Operators - 运算符

## 📋 学习目标
- 掌握Go语言的各种运算符
- 理解运算符优先级和结合性
- 对比Java和Go运算符的差异
- 学会位运算和逻辑运算的应用

## 🔢 运算符分类

### 1. 算术运算符

| 运算符 | 说明 | Go示例 | Java示例 |
|--------|------|--------|----------|
| + | 加法 | `a + b` | `a + b` |
| - | 减法 | `a - b` | `a - b` |
| * | 乘法 | `a * b` | `a * b` |
| / | 除法 | `a / b` | `a / b` |
| % | 取模 | `a % b` | `a % b` |
| ++ | 自增 | `a++` | `++a` 或 `a++` |
| -- | 自减 | `a--` | `--a` 或 `a--` |

**关键差异：**
- Go只支持后置的 `++` 和 `--`
- Go的 `++` 和 `--` 是语句，不是表达式

### 2. 关系运算符

| 运算符 | 说明 | Go示例 | Java示例 |
|--------|------|--------|----------|
| == | 等于 | `a == b` | `a == b` |
| != | 不等于 | `a != b` | `a != b` |
| < | 小于 | `a < b` | `a < b` |
| <= | 小于等于 | `a <= b` | `a <= b` |
| > | 大于 | `a > b` | `a > b` |
| >= | 大于等于 | `a >= b` | `a >= b` |

### 3. 逻辑运算符

| 运算符 | 说明 | Go示例 | Java示例 |
|--------|------|--------|----------|
| && | 逻辑与 | `a && b` | `a && b` |
| \|\| | 逻辑或 | `a \|\| b` | `a \|\| b` |
| ! | 逻辑非 | `!a` | `!a` |

### 4. 位运算符

| 运算符 | 说明 | Go示例 | Java示例 |
|--------|------|--------|----------|
| & | 按位与 | `a & b` | `a & b` |
| \| | 按位或 | `a \| b` | `a \| b` |
| ^ | 按位异或 | `a ^ b` | `a ^ b` |
| &^ | 位清空(Go特有) | `a &^ b` | `a & (~b)` |
| << | 左移 | `a << 2` | `a << 2` |
| >> | 右移 | `a >> 2` | `a >> 2` |

**Go特有的位清空运算符：**
- `a &^ b` 等价于 `a & (^b)`
- 将a中对应b为1的位清零

### 5. 赋值运算符

| 运算符 | 说明 | Go示例 | Java示例 |
|--------|------|--------|----------|
| = | 赋值 | `a = b` | `a = b` |
| += | 加后赋值 | `a += b` | `a += b` |
| -= | 减后赋值 | `a -= b` | `a -= b` |
| *= | 乘后赋值 | `a *= b` | `a *= b` |
| /= | 除后赋值 | `a /= b` | `a /= b` |
| %= | 取模后赋值 | `a %= b` | `a %= b` |
| &= | 按位与后赋值 | `a &= b` | `a &= b` |
| \|= | 按位或后赋值 | `a \|= b` | `a \|= b` |
| ^= | 按位异或后赋值 | `a ^= b` | `a ^= b` |
| <<= | 左移后赋值 | `a <<= 2` | `a <<= 2` |
| >>= | 右移后赋值 | `a >>= 2` | `a >>= 2` |
| &^= | 位清空后赋值 | `a &^= b` | 无 |

### 6. 其他运算符

| 运算符 | 说明 | Go示例 | Java示例 |
|--------|------|--------|----------|
| & | 取地址 | `&a` | 无(引用) |
| * | 取值/解引用 | `*p` | 无(自动解引用) |
| <- | 通道操作 | `<-ch` | 无 |
| ... | 可变参数 | `func(args ...int)` | `func(int... args)` |

## 📊 运算符优先级

从高到低：

1. `() [] ->` (最高优先级)
2. `! ~ ++ -- + - * &` (一元运算符)
3. `* / %` (乘除模)
4. `+ -` (加减)
5. `<< >>` (位移)
6. `&` (按位与)
7. `^` (按位异或)
8. `|` (按位或)
9. `== != < <= > >=` (关系运算)
10. `&&` (逻辑与)
11. `||` (逻辑或)
12. `=` (赋值运算符，最低优先级)

## 🎯 关键差异和注意事项

### 1. 自增自减运算符
```go
// Go只支持后置
i++  // 正确
i--  // 正确
++i  // 编译错误
--i  // 编译错误

// 且它们是语句，不是表达式
x := i++  // 编译错误
```

```java
// Java支持前置和后置
i++;     // 正确
i--;     // 正确  
++i;     // 正确
--i;     // 正确

// 且它们是表达式
int x = i++;  // 正确
```

### 2. 位清空运算符
```go
// Go特有的位清空运算符
a := 0b1100  // 12
b := 0b1010  // 10
c := a &^ b  // 0b0100 = 4, 清空a中b为1的位
```

```java
// Java需要组合运算符实现
int a = 0b1100;  // 12
int b = 0b1010;  // 10  
int c = a & (~b); // 实现位清空
```

### 3. 字符串比较
```go
// Go可以直接比较字符串
str1 := "hello"
str2 := "world"
if str1 < str2 {  // 按字典序比较
    fmt.Println("str1 < str2")
}
```

```java
// Java字符串比较需要方法
String str1 = "hello";
String str2 = "world";
if (str1.compareTo(str2) < 0) {  // 不能直接用<
    System.out.println("str1 < str2");
}
```

### 4. 空值检查
```go
// Go使用nil
var p *int
if p == nil {
    fmt.Println("指针为空")
}

var slice []int
if slice == nil {
    fmt.Println("切片为空")
}
```

```java
// Java使用null
Integer p = null;
if (p == null) {
    System.out.println("引用为空");
}

List<Integer> list = null;
if (list == null) {
    System.out.println("列表为空");
}
```

## 💡 实用技巧

### 1. 位运算技巧
```go
// 判断奇偶
if n&1 == 1 {
    fmt.Println("奇数")
}

// 快速乘除2的幂
n := n << 1  // 乘以2
n := n >> 1  // 除以2

// 交换两个数（不推荐，可读性差）
a ^= b
b ^= a  
a ^= b
```

### 2. 逻辑运算短路
```go
// 利用短路特性避免空指针
if p != nil && p.field > 0 {
    // 安全访问
}

// 或运算的默认值模式
value := getValue() || getDefaultValue()
```

### 3. 条件表达式模拟
```go
// Go没有三元运算符，但可以用函数模拟
func ternary(condition bool, trueVal, falseVal int) int {
    if condition {
        return trueVal
    }
    return falseVal
}

result := ternary(a > b, a, b)
```

## 📝 实践任务

### 任务1: 基础运算
1. 实现一个计算器程序
2. 练习各种运算符的使用
3. 对比Java的实现方式

### 任务2: 位运算应用
1. 实现权限检查系统（使用位掩码）
2. 练习位运算技巧
3. 理解Go特有的位清空运算符

### 任务3: 表达式求值
1. 实现表达式解析器
2. 处理运算符优先级
3. 理解运算符结合性

## 🎯 学习要点

### Go运算符特点
1. **简化设计**: 去掉了复杂的前置自增自减
2. **位清空运算符**: 独有的 `&^` 运算符
3. **字符串比较**: 可以直接比较字符串
4. **类型安全**: 严格的类型检查

### 与Java的主要差异
1. **自增自减**: 只支持后置，且是语句不是表达式
2. **三元运算符**: Go没有 `? :` 运算符
3. **位运算**: 增加了位清空运算符
4. **指针运算**: 有地址和解引用运算符

## 🎯 下一步
- 学习控制流语句
- 理解函数定义和调用
- 掌握数据结构操作

## 📚 参考文档
- [Go语言规范 - 运算符](https://golang.org/ref/spec#Operators)
- [Go语言规范 - 表达式](https://golang.org/ref/spec#Expressions)
- [Effective Go - 控制结构](https://golang.org/doc/effective_go.html#control-structures) 